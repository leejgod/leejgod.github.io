<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="å…³äºå¯†ç å­¦çš„ç§ç§æ¼æ´ä»¥åŠåˆ©ç”¨ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘ï¼Œä½†æ˜¯æ¯”è¾ƒé›¶æ•£ï¼Œæœ‰å…³ä»‹ç»æ¯”è¾ƒå±€é™ï¼Œå¯¼è‡´ä¸€äº›ä¸œè¥¿æ™¦æ¶©éš¾æ‡‚ä¸æ˜“ç†è§£ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªæœ‰å…³äºCBCåˆ†ç»„åŠ å¯†çš„ä¸€ä¸ªè®²è§£">
<meta name="keywords" content="å¯†ç å­¦">
<meta property="og:type" content="article">
<meta property="og:title" content="åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·">
<meta property="og:url" content="http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/index.html">
<meta property="og:site_name" content="Leej">
<meta property="og:description" content="å…³äºå¯†ç å­¦çš„ç§ç§æ¼æ´ä»¥åŠåˆ©ç”¨ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘ï¼Œä½†æ˜¯æ¯”è¾ƒé›¶æ•£ï¼Œæœ‰å…³ä»‹ç»æ¯”è¾ƒå±€é™ï¼Œå¯¼è‡´ä¸€äº›ä¸œè¥¿æ™¦æ¶©éš¾æ‡‚ä¸æ˜“ç†è§£ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªæœ‰å…³äºCBCåˆ†ç»„åŠ å¯†çš„ä¸€ä¸ªè®²è§£">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffgtp29e1oj211t0i1dhg.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffgtpm50czj21050frmyk.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffgu1ahos3j210u0dgdhj.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffgu1xi3qoj21460cstar.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffguy1ae90j20lo09lt97.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1ly1ffkan9bhisj20oi08kab5.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkb8les6tj20f206mgm2.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkbgq2ag6j20f1076wf8.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkc7h3gafj20dp0773z8.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkck29su9j20dp07cmxw.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkd1mg5ssj20e207jaat.jpg">
<meta property="og:updated_time" content="2018-02-07T04:11:15.627Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·">
<meta name="twitter:description" content="å…³äºå¯†ç å­¦çš„ç§ç§æ¼æ´ä»¥åŠåˆ©ç”¨ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘ï¼Œä½†æ˜¯æ¯”è¾ƒé›¶æ•£ï¼Œæœ‰å…³ä»‹ç»æ¯”è¾ƒå±€é™ï¼Œå¯¼è‡´ä¸€äº›ä¸œè¥¿æ™¦æ¶©éš¾æ‡‚ä¸æ˜“ç†è§£ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªæœ‰å…³äºCBCåˆ†ç»„åŠ å¯†çš„ä¸€ä¸ªè®²è§£">
<meta name="twitter:image" content="http://ww1.sinaimg.cn/large/7e2785d1gy1ffgtp29e1oj211t0i1dhg.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/leejgod">Projects</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2017/05/16/å‡¤æ±‚å‡°/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2017/04/25/Falseæ³¨å…¥,ä»¥åŠSQLæ³¨å…¥æŠ€å·§æ€»ç»“/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&text=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&is_video=false&description=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·&body=Check out this article: http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&name=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·&description=&lt;p&gt;å…³äºå¯†ç å­¦çš„ç§ç§æ¼æ´ä»¥åŠåˆ©ç”¨ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘ï¼Œä½†æ˜¯æ¯”è¾ƒé›¶æ•£ï¼Œæœ‰å…³ä»‹ç»æ¯”è¾ƒå±€é™ï¼Œå¯¼è‡´ä¸€äº›ä¸œè¥¿æ™¦æ¶©éš¾æ‡‚ä¸æ˜“ç†è§£ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªæœ‰å…³äºCBCåˆ†ç»„åŠ å¯†çš„ä¸€ä¸ªè®²è§£&lt;/p&gt;"><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CBCåŠ å¯†æ¨¡å¼"><span class="toc-number">1.</span> <span class="toc-text">CBCåŠ å¯†æ¨¡å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#å­—èŠ‚ç¿»è½¬æ”»å‡»"><span class="toc-number">1.1.</span> <span class="toc-text">å­—èŠ‚ç¿»è½¬æ”»å‡»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°"><span class="toc-number">1.1.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è¯¦è§£"><span class="toc-number">1.1.2.</span> <span class="toc-text">è¯¦è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CTFå®ä¾‹"><span class="toc-number">1.1.3.</span> <span class="toc-text">CTFå®ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Padding-Oracle-Attack"><span class="toc-number">1.2.</span> <span class="toc-text">Padding Oracle Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è¯¦è§£-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">è¯¦è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å®ä¾‹"><span class="toc-number">1.2.3.</span> <span class="toc-text">å®ä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å‚è€ƒ"><span class="toc-number">1.2.4.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Leej</span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-05-15T02:04:47.000Z" itemprop="datePublished">2017-05-15</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/å¯†ç å­¦/">å¯†ç å­¦</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>å…³äºå¯†ç å­¦çš„ç§ç§æ¼æ´ä»¥åŠåˆ©ç”¨ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘ï¼Œä½†æ˜¯æ¯”è¾ƒé›¶æ•£ï¼Œæœ‰å…³ä»‹ç»æ¯”è¾ƒå±€é™ï¼Œå¯¼è‡´ä¸€äº›ä¸œè¥¿æ™¦æ¶©éš¾æ‡‚ä¸æ˜“ç†è§£ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªæœ‰å…³äºCBCåˆ†ç»„åŠ å¯†çš„ä¸€ä¸ªè®²è§£</p>
<a id="more"></a>
<h1 id="CBCåŠ å¯†æ¨¡å¼"><a href="#CBCåŠ å¯†æ¨¡å¼" class="headerlink" title="CBCåŠ å¯†æ¨¡å¼"></a>CBCåŠ å¯†æ¨¡å¼</h1><p>é¦–å…ˆä¸Šå›¾</p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffgtp29e1oj211t0i1dhg.jpg" alt="">  </p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffgtpm50czj21050frmyk.jpg" alt=""> </p>
<p>è¿™é‡Œæ–‡å­—æè¿°ä¸å¦‚çœ‹å›¾ç›´è§‚ï¼Œè¿˜æ˜¯å¤§è‡´æè¿°ä¸€ä¸‹ï¼ŒCBCæ¨¡å¼çš„åŠ å¯†æ–¹å¼æ˜¯é€šè¿‡ä¸€ä¸ªåˆå§‹å‘é‡ï¼ˆIVï¼‰å…ˆå’Œæ˜æ–‡åˆ†ç»„ç¬¬ä¸€ç»„å¼‚æˆ–åä½¿ç”¨ç§˜é’¥KåŠ å¯†ï¼Œä½œä¸ºç¬¬ä¸€ç»„å¯†æ–‡ï¼ŒåŒæ—¶åˆä¸åä¸€åˆ†ç»„çš„æ˜æ–‡å¼‚æˆ–åè¿›è¡ŒåŠ å¯†äº§ç”Ÿä¸‹ä¸€ç»„å¯†æ–‡ï¼Œä¾æ¬¡é‡å¤ã€‚</p>
<p>å…¶è§£å¯†å’ŒåŠ å¯†æ˜¯å¯¹ç§°çš„ï¼Œå¯†æ–‡å…ˆè§£å¯†ï¼Œå†å¼‚æˆ–ã€‚</p>
<p>å…³äºè¿™ä¸ªåˆå§‹å‘é‡IVçš„å®Œæ•´æ€§è¦æ¯”å…¶ä¿å¯†æ€§æ›´ä¸ºé‡è¦ã€‚åœ¨CBCæ¨¡å¼ä¸‹ï¼Œæœ€å¥½æ˜¯æ¯å‘ä¸€ä¸ªæ¶ˆæ¯ï¼Œéƒ½æ”¹å˜IVï¼Œæ¯”å¦‚å°†å…¶å€¼åŠ ä¸€ã€‚</p>
<p>è¿™é‡Œè¯´è¯´æœ‰å…³äºCBCçš„é”™è¯¯ä¼ æ’­ï¼Œæœ‰åˆ©äºä¹‹åå­—èŠ‚ç¿»è½¬æ”»å‡»çš„ç†è§£</p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffgu1ahos3j210u0dgdhj.jpg" alt="">  </p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffgu1xi3qoj21460cstar.jpg" alt="">  </p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffguy1ae90j20lo09lt97.jpg" alt="">  </p>
<p>å…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p>
<ol>
<li>æ˜æ–‡æœ‰ä¸€ç»„ä¸­æœ‰é”™ï¼Œä¼šä½¿ä»¥åçš„å¯†æ–‡ç»„éƒ½å—å½±å“ï¼Œä½†ç»è§£å¯†åçš„æ¢å¤ç»“æœï¼Œé™¤åŸæœ‰è¯¯çš„ä¸€ç»„å¤–ï¼Œå…¶åå„ç»„æ˜æ–‡éƒ½æ­£ç¡®åœ°æ¢å¤ã€‚</li>
<li>è§£å¯†æ—¶ï¼Œæœ‰ä¸€ç»„ç§˜é’¥é”™è¯¯ï¼Œè¯¥é”™è¯¯ä¼šå½±å“ä¸‹ä¸€åˆ†ç»„ç›¸åŒä½ç½®çš„è§£å¯†</li>
<li>è‹¥åœ¨ä¼ é€è¿‡ç¨‹ä¸­ï¼ŒæŸç»„å¯†æ–‡ç»„å‡ºé”™æ—¶ï¼Œåˆ™è¯¥ç»„æ¢å¤çš„æ˜æ–‡å’Œä¸‹ä¸€ç»„æ¢å¤æ•°æ®å‡ºé”™ã€‚å†åé¢çš„ç»„å°†ä¸ä¼šå—ä¸­é”™è¯¯æ¯”ç‰¹çš„å½±å“ã€‚</li>
</ol>
<h2 id="å­—èŠ‚ç¿»è½¬æ”»å‡»"><a href="#å­—èŠ‚ç¿»è½¬æ”»å‡»" class="headerlink" title="å­—èŠ‚ç¿»è½¬æ”»å‡»"></a>å­—èŠ‚ç¿»è½¬æ”»å‡»</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>æœ‰å…³äºè¿™é‡Œçš„æ”»å‡»ï¼Œæ²¡æœ‰ä¸‹é¢é‚£ç§æ–¹å¼åˆºæ¿€ï¼Œä½†æ˜¯æ•ˆæœä¹Ÿè¿˜æ˜¯å¯ä»¥</p>
<p>è¿™é‡Œæœ€å¤§çš„æ•ˆæœå°±æ˜¯ï¼š<strong>åœ¨ä¸çŸ¥é“Key(ç§˜é’¥)çš„æƒ…å†µä¸‹ç¯¡æ”¹æ˜æ–‡</strong>ã€‚</p>
<p>é€šè¿‡ä¸Šé¢çš„é”™è¯¯ä¼ æ’­ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°ï¼Œè§£å¯†æ—¶é€šè¿‡ä¿®æ”¹å‰ä¸€ä¸ªå¯†æ–‡åˆ†ç»„å¯ä»¥å½±å“åä¸€ä¸ªçš„è§£å¯†åçš„æ˜æ–‡åˆ†ç»„</p>
<p>è¿™é‡Œä¿®æ”¹å¯ä»¥å°†å‰ä¸€ä¸ªå¯†æ–‡ä¸­çš„ä»»æ„æ¯”ç‰¹è¿›è¡Œä¿®æ”¹ï¼ˆ0,1è¿›è¡Œç¿»è½¬ï¼‰</p>
<h3 id="è¯¦è§£"><a href="#è¯¦è§£" class="headerlink" title="è¯¦è§£"></a>è¯¦è§£</h3><p>è¿™é‡Œä¸¾ä¸ªä¾‹å­ï¼š</p>
<p>æ˜æ–‡æ˜¯â€lee-jayy:12345678$,ohh he is very rich!â€</p>
<p>è¿™é‡Œä½¿ç”¨DESç®—æ³•ï¼Œç§˜é’¥<code>key = &quot;leejleej&quot;</code>åˆå§‹å‘é‡<code>iv=&#39;thisisiv&#39;</code></p>
<p>åŠ å¯†ç»“æœä¸ºï¼š<code>04f2e7d245cec18f6c1769c66f0e30ccc30a378c58597b15409a0a8c296df6a66a10679b55ddbabb</code></p>
<p>ç¬¬ä¸€æ­¥å°†æ¶ˆæ¯åˆ†ç»„ï¼Œå…¶desç®—æ³•çš„åˆ†ç»„é•¿åº¦æ˜¯64bitï¼Œä¸€ä¸ªå­—ç¬¦æ˜¯8bitæ•…8ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œå¦‚ä¸‹</p>
<p>ç¬¬ä¸€ç»„ï¼š<code>lee-jayy</code></p>
<p>ç¬¬äºŒç»„ï¼š<code>:1234567</code></p>
<p>ç¬¬ä¸‰ç»„ï¼š<code>8$,ohh h</code></p>
<p>ç¬¬å››ç»„ï¼š<code>eis ver</code></p>
<p>ç¬¬äº”ç»„ï¼š<code>y rich!</code></p>
<p>è¿™é‡Œæˆ‘æƒ³æŠŠç¬¬äºŒç»„çš„ç¬¬2ä¸ªå­—ç¬¦â€œ1â€æ”¹ä¸ºâ€œ9â€ï¼Œè¿™é‡Œè¯¥å¦‚ä½•æ“ä½œï¼Ÿ</p>
<p>ç”±ä¸Šé¢çš„ç‰¹ç‚¹æˆ‘ä»¬çŸ¥é“ï¼Œä¿®æ”¹ç¬¬nåˆ†ç»„çš„ç§˜æ–‡ï¼Œå…¶ç¬¬n+1åˆ†ç»„çš„æ˜æ–‡ä¼šè¢«çªœæ”¹ï¼Œè¿™é‡Œæˆ‘ä»¬å¾…ä¿®æ”¹çš„å­—ç¬¦åœ¨ç¬¬äºŒåˆ†ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ç¬¬ä¸€åˆ†ç»„çš„å¯†æ–‡æ¥æ§åˆ¶ç¬¬äºŒåˆ†ç»„ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿æˆ‘æŠŠå¯†æ–‡ä¹Ÿåˆ†ç»„ä¸€ä¸‹ï¼š</p>
<p>04f2e7d245cec18f</p>
<p>6c1769c66f0e30cc</p>
<p>c30a378c58597b15</p>
<p>409a0a8c296df6a6</p>
<p>6a10679b55ddbabb</p>
<p>ç”±äºè¿™é‡Œéœ€è¦ä¿®æ”¹çš„å­—ç¬¦â€œ1â€ä½äºç¬¬äºŒåˆ†ç»„çš„ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€ä¿®æ”¹ç¬¬ä¸€åˆ†ç»„ç›¸åŒçš„ä½ç½®çš„å¯†æ–‡</p>
<p>ï¼Œä¸€ä¸ªå­—ç¬¦æ˜¯16bitä¸¤ä¸ªåå…­è¿›åˆ¶ä½ï¼Œæ•…æˆ‘ä»¬éœ€è¦ä¿®æ”¹ç¬¬ä¸€åˆ†ç»„å¯†æ–‡çš„â€œf2â€ï¼Œè¿™é‡Œæ”¹å¦‚ä½•æ”¹å‘¢ï¼Ÿ</p>
<p>åœ¨æ”¹ä¹‹å‰æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸ªåŸºæœ¬çŸ¥è¯†ï¼Œæœ‰å…³äºå¼‚æˆ–ï¼š</p>
<p>å¼‚æˆ–çš„è§„åˆ™æ˜¯ç›¸åŒä¸º0ï¼Œä¸åŒä¸º1</p>
<p>äºæ˜¯æœ‰1 xor 1 =0ï¼Œ1 xor 0 =1ï¼Œ0 xor 0 = 0</p>
<p>å¯ä»¥çœ‹å‡ºè¿™ä¹ˆä¸€ä¸ªè§„åˆ™ï¼Œ<strong>A xor B = C  &lt;=&gt; A xor C = B</strong></p>
<p>è¿™æ—¶å€™å¯ä»¥å›çœ‹ä¸€ä¸‹ä¸Šé¢çš„è§£å¯†çš„å›¾</p>
<p>æˆ‘ä»¬çŸ¥é“çš„ä¸œè¥¿æœ‰ï¼š</p>
<p>1ã€ç¬¬äºŒç»„desç®—æ³•åŠ å¯†åè¦å’Œç¬¬ä¸€ç»„çš„å¯†æ–‡å¼‚æˆ–å¾—åˆ°ç¬¬äºŒç»„çš„å¯†æ–‡</p>
<p>2ã€å­—ç¬¦1çš„asciiç 16è¿›åˆ¶æ˜¯31</p>
<p>3ã€å­—ç¬¦1ç»è¿‡cbcåçš„å¯†æ–‡è¦å’Œf2è¿›è¡Œå¼‚æˆ–</p>
<p>è¿™é‡Œæˆ‘ä»¬å¹¶ä¸æ™“å¾—å…¶ç§˜é’¥keyï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾ç¬¬äºŒç»„desç®—æ³•åŠ å¯†å16è¿›åˆ¶æ˜¯ABCDEFGHIGKLMNOPï¼Œæ•…å­—ç¬¦1ç»è¿‡DESåŠ å¯†çš„ç»“æœæ˜¯AB</p>
<p>ç¬¬ä¸€æ­¥ã€æˆ‘ä»¬æ ¹æ®ä¸Šé¢çš„ç®—æ³•çŸ¥é“  AB xor f2 = 31ï¼Œè¿™é‡Œ04æ˜¯å­—ç¬¦1çš„å¯†æ–‡ï¼Œæˆ‘ä»¬éœ€è¦è§£å‡ºABï¼Œåªéœ€è¦f2 xor 31æ—¢å¯å¾—å‡º1ç»è¿‡desç®—æ³•åŠ å¯†åæ˜¯C3</p>
<p>ç¬¬äºŒæ­¥ã€æˆ‘ä»¬åˆ©ç”¨ä¸Šä¸€æ­¥è®¡ç®—å‡ºçš„DESå¯¹å­—ç¬¦1åŠ å¯†çš„ç»“æœ35å¼‚æˆ–å¾…ä¿®æ”¹çš„å­—ç¬¦â€œ9â€(å…¶asciiç ä¸º39)ã€‚</p>
<p>C3 xor 39 = FA</p>
<p>ç¬¬ä¸‰æ­¥ã€ä¿®æ”¹å¯†æ–‡ä¸­ç¬¬ä¸€åˆ†ç»„å¼€å§‹çš„f2ä¸ºFAï¼Œä¿®æ”¹åçš„å¯†æ–‡æ˜¯ï¼š</p>
<p><code>04FAe7d245cec18f6c1769c66f0e30ccc30a378c58597b15409a0a8c296df6a66a10679b55ddbabb</code></p>
<p>å¯ä»¥å¯¹æ¯”ä¸€ä¸‹è¾“å‡ºï¼š</p>
<p>ä¿®æ”¹å‰ï¼š<code>lee-jayy:12345678$,ohh he is very rich!</code></p>
<p>ä¿®æ”¹åï¼š<code>4ç³‰LæŸ–292345678$,ohh he is very rich!</code></p>
<p>çœ‹å‡ºå¯¹åº”çš„1çš„ç¡®å˜ä¸ºäº†9</p>
<p>åˆ©ç”¨åŒæ ·æ–¹æ³•æˆ‘æŠŠ1234567ä¿®æ”¹ä¸ºäº†9999999ï¼Œç§˜æ–‡ä¸º<code>04FAECD848C2CE816c1769c66f0e30ccc30a378c58597b15409a0a8c296df6a66a10679b55ddbabb</code></p>
<p>ç»“æœï¼š<code>dÂ&amp;Ï†Î¤5Ï‚:99999998$,ohh he is very rich!</code></p>
<p>åŠ å¯†è„šç¬¨å¦‚ä¸‹,æœ‰å…´è¶£å¯ä»¥è‡ªå·±è¯•ä¸€è¯•ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jiami_DES</span><span class="params">($input = <span class="string">""</span>,$key = <span class="string">"leejleej"</span>,$iv=<span class="string">'thisisiv'</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$td = mcrypt_module_open(MCRYPT_DES, <span class="string">''</span>, MCRYPT_MODE_CBC, <span class="string">''</span>);</span><br><span class="line">mcrypt_generic_init($td, $key, $iv);</span><br><span class="line"></span><br><span class="line">$encrypted_data = mcrypt_generic($td, $input);</span><br><span class="line"></span><br><span class="line">mcrypt_generic_deinit($td);</span><br><span class="line">mcrypt_module_close($td);</span><br><span class="line"><span class="keyword">return</span> bin2hex($encrypted_data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jiemi_DES</span><span class="params">($input = <span class="string">""</span>,$key = <span class="string">"leejleej"</span>,$iv=<span class="string">'thisisiv'</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$td = mcrypt_module_open(MCRYPT_DES, <span class="string">''</span>, MCRYPT_MODE_CBC, <span class="string">''</span>);</span><br><span class="line">mcrypt_generic_init($td, $key, $iv);</span><br><span class="line">$mdecrypted_data = mdecrypt_generic($td,hex2bin($input));<span class="comment">//$encrypted_data);</span></span><br><span class="line">mcrypt_generic_deinit($td);</span><br><span class="line">mcrypt_module_close($td);</span><br><span class="line"><span class="keyword">return</span> $mdecrypted_data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> jiami_DES(<span class="string">'lee-jayy:12345678$,ohh he is very rich!'</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> jiemi_DES($_GET[<span class="string">'key'</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="CTFå®ä¾‹"><a href="#CTFå®ä¾‹" class="headerlink" title="CTFå®ä¾‹"></a>CTFå®ä¾‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> twisted.internet <span class="keyword">import</span> reactor, protocol</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> KEY,KEYSIZE,IV,FLAG</span><br><span class="line"></span><br><span class="line">PORT = <span class="number">6666</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span><span class="params">(instr, length)</span>:</span></span><br><span class="line">        <span class="keyword">if</span>(length == <span class="keyword">None</span>):</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"Supply a length to pad to"</span></span><br><span class="line">        <span class="keyword">elif</span>(len(instr) % length == <span class="number">0</span>):</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"No Padding Needed"</span></span><br><span class="line">                <span class="keyword">return</span> instr</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> instr + <span class="string">'\x04'</span> * (length - (len(instr) % length ))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_block</span><span class="params">(key, plaintext)</span>:</span></span><br><span class="line">        encobj = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        <span class="keyword">return</span> encobj.encrypt(plaintext).encode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_block</span><span class="params">(key, ctxt)</span>:</span></span><br><span class="line">        decobj = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        <span class="keyword">return</span> decobj.decrypt(ctxt).encode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_block</span><span class="params">(first,second)</span>:</span></span><br><span class="line">        <span class="keyword">if</span>(len(first) != len(second)):</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"Blocks need to be the same length!"</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">        first = list(first)</span><br><span class="line">        second = list(second)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(first)):</span><br><span class="line">                first[i] = chr(ord(first[i]) ^ ord(second[i]))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(first)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_cbc</span><span class="params">(key,IV, plaintext)</span>:</span></span><br><span class="line">        <span class="keyword">if</span>(len(plaintext) % len(key) != <span class="number">0</span>): <span class="comment">#åŠ å¯†æ–‡æœ¬çš„é•¿åº¦å¿…é¡»èƒ½æ•´é™¤Key,å¦åˆ™åœ¨åé¢åŠ x40</span></span><br><span class="line">                plaintext = pad(plaintext,len(key))</span><br><span class="line">        blocks = [plaintext[x:x+len(key)] <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,len(plaintext),len(key))]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(blocks)):</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">0</span>):</span><br><span class="line">                        ctxt = xor_block(blocks[i],IV)</span><br><span class="line">                        ctxt = encrypt_block(key,ctxt)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                        tmp = xor_block(blocks[i],ctxt[<span class="number">-1</span> * (len(key) * <span class="number">2</span>):].decode(<span class="string">'hex'</span>)) </span><br><span class="line">                        ctxt = ctxt + encrypt_block(key,tmp)</span><br><span class="line">        <span class="keyword">return</span> ctxt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_cbc</span><span class="params">(key,IV,ctxt)</span>:</span></span><br><span class="line">        ctxt = ctxt.decode(<span class="string">'hex'</span>)</span><br><span class="line">        <span class="keyword">if</span>(len(ctxt) % len(key) != <span class="number">0</span>):</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"Invalid Key."</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        blocks = [ctxt[x:x+len(key)] <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,len(ctxt),len(key))]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(blocks)):</span><br><span class="line">                <span class="comment">#print blocks[0].encode('hex')</span></span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">0</span>):</span><br><span class="line">                        ptxt = decrypt_block(key,blocks[i])</span><br><span class="line">                        ptxt = xor_block(ptxt.decode(<span class="string">'hex'</span>),IV)</span><br><span class="line">                        <span class="comment">#print ptxt.encode('hex')</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                        tmp = decrypt_block(key,blocks[i])</span><br><span class="line">                        tmp = xor_block(tmp.decode(<span class="string">'hex'</span>),blocks[i<span class="number">-1</span>])</span><br><span class="line">                        ptxt = ptxt + tmp</span><br><span class="line">        <span class="keyword">return</span> ptxt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mkprofile</span><span class="params">(email)</span>:</span></span><br><span class="line">	<span class="keyword">if</span>((<span class="string">";"</span> <span class="keyword">in</span> email)):</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">	prefix = <span class="string">"comment1=wowsuch%20CBC;userdata="</span></span><br><span class="line">	suffix = <span class="string">";coment2=%20suchsafe%20very%20encryptwowww"</span></span><br><span class="line">	</span><br><span class="line">	ptxt = prefix + email + suffix <span class="comment">#è¿æ¥å­—ç¬¦ä¸²</span></span><br><span class="line">	<span class="keyword">print</span> ptxt</span><br><span class="line">	<span class="keyword">return</span> encrypt_cbc(KEY,IV,ptxt)	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_profile</span><span class="params">(data)</span>:</span></span><br><span class="line">	<span class="keyword">print</span> <span class="string">"DATA:"</span></span><br><span class="line">	<span class="keyword">print</span> data	</span><br><span class="line">	ptxt = decrypt_cbc(KEY,IV,data.encode(<span class="string">'hex'</span>))</span><br><span class="line">	ptxt = ptxt.replace(<span class="string">"\x04"</span>,<span class="string">""</span>)</span><br><span class="line">	<span class="keyword">print</span> ptxt</span><br><span class="line">	<span class="keyword">if</span> <span class="string">";admin=true"</span> <span class="keyword">in</span> ptxt:</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyServer</span><span class="params">(protocol.Protocol)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dataReceived</span><span class="params">(self,data)</span>:</span></span><br><span class="line">	<span class="keyword">if</span>(len(data) &gt; <span class="number">512</span>):</span><br><span class="line">		self.transport.write(<span class="string">"Data too long.\n"</span>)</span><br><span class="line">		self.transport.loseConnection()</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(data.startswith(<span class="string">"mkprof:"</span>)):</span><br><span class="line">		data = data[<span class="number">7</span>:]</span><br><span class="line">		resp = mkprofile(data)</span><br><span class="line">		<span class="keyword">if</span> (resp == <span class="number">-1</span>):</span><br><span class="line">			self.transport.write(<span class="string">"No Cheating!\n"</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			self.transport.write(resp + <span class="string">'\n'</span>)</span><br><span class="line">	<span class="keyword">elif</span>(data.startswith(<span class="string">"parse:"</span>)):</span><br><span class="line">		self.transport.write(<span class="string">"Parsing Profile..."</span>)</span><br><span class="line">		data = data[<span class="number">6</span>:].decode(<span class="string">'hex'</span>)</span><br><span class="line">		<span class="keyword">if</span> (len(data) % KEYSIZE != <span class="number">0</span>):</span><br><span class="line">			self.transport.write(<span class="string">"Invalid Ciphertext &lt;length&gt;\n"</span>)</span><br><span class="line">			self.transport.loseConnection()</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(parse_profile(data) == <span class="number">1</span>):</span><br><span class="line">			self.transport.write(<span class="string">"Congratulations!\nThe FLAG is: "</span>)</span><br><span class="line">			self.transport.write(FLAG)</span><br><span class="line">			self.transport.loseConnection()</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			self.transport.write(<span class="string">"You are a normal user.\n"</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		self.transport.write(<span class="string">"Syntax Error"</span>)</span><br><span class="line">		self.transport.loseConnection()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyServerFactory</span><span class="params">(protocol.Factory)</span>:</span></span><br><span class="line">    protocol = MyServer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">factory = MyServerFactory()</span><br><span class="line">reactor.listenTCP(PORT, factory)</span><br><span class="line">reactor.run()</span><br></pre></td></tr></table></figure>
<p>wp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = remote(<span class="string">'133.130.52.128'</span>,<span class="number">6666</span>)</span><br><span class="line">target = <span class="string">";admin=true"</span></span><br><span class="line">email = <span class="string">'0000000000000000000000'</span></span><br><span class="line">prefix = <span class="string">"comment1=wowsuch%20CBC;userdata="</span></span><br><span class="line">suffix = <span class="string">";coment2=%20suchsafe%20very%20encryptwowww"</span></span><br><span class="line">ptxt = prefix + email + suffix</span><br><span class="line"></span><br><span class="line">sh.send(<span class="string">'mkprof:'</span> + email)</span><br><span class="line">s = sh.recv(<span class="number">1024</span>)[<span class="number">0</span>:len(ptxt)*<span class="number">2</span>]</span><br><span class="line">s = list(s.decode(<span class="string">'hex'</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(target)):</span><br><span class="line">    s[<span class="number">32</span>+i] = p8( u8(s[<span class="number">32</span>+i]) ^ u8(target[i]) ^ u8(ptxt[<span class="number">48</span>+i]) )</span><br><span class="line">s = <span class="string">''</span>.join(s).encode(<span class="string">'hex'</span>)</span><br><span class="line">sh.send(<span class="string">'parse:'</span> + s)</span><br><span class="line"><span class="keyword">print</span> sh.recv(<span class="number">1024</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Padding-Oracle-Attack"><a href="#Padding-Oracle-Attack" class="headerlink" title="Padding Oracle Attack"></a>Padding Oracle Attack</h2><h3 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>æœ‰å…³äºè¿™ç§æ–¹å¼çš„æ”»å‡»ï¼Œå®åœ¨æ˜¯å·§å¦™ï¼</p>
<p>é¦–å…ˆè¯´ä¸€ä¸‹ä½¿ç”¨æ¡ä»¶ï¼Œä»¥åŠå¯ä»¥è¾¾åˆ°çš„æ•ˆæœã€‚</p>
<p>ä½¿ç”¨æ¡ä»¶ï¼š</p>
<p>ä¸€ã€<code>æˆ‘ä»¬å¯ä»¥ä¿®æ”¹iv(åœ¨æˆ‘çš„ç†è§£å…¶å®è¿™é‡Œå¦‚æœæ•°æ®åˆ†ç»„å¤§äº1ç»„å…¶å®ä¸éœ€è¦ivä¹Ÿå¯ä»¥è¿›è¡Œæ”»å‡»)</code></p>
<p>äºŒã€<code>æˆ‘ä»¬çŸ¥é“å¯†æ–‡</code></p>
<p>ä¸‰ã€<code>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æœåŠ¡ç«¯è¿›è¡Œè§£å¯†</code></p>
<p>æ•ˆæœï¼š<code>è·å–æ˜æ–‡ï¼(å¦‚æœåˆ†ç»„å¤§äº1ç»„ï¼Œæ²¡æœ‰ivçš„æƒ…å†µè¿™é‡Œå¯ä»¥è·å–åˆ°éƒ¨åˆ†æ˜æ–‡)</code></p>
<h3 id="è¯¦è§£-1"><a href="#è¯¦è§£-1" class="headerlink" title="è¯¦è§£"></a>è¯¦è§£</h3><p>é¦–å…ˆä»‹ç»ä¸€ä¸‹å¯¹äºåˆ†ç»„åŠ å¯†è¿‡ç¨‹ä¸­æ•°æ®å¡«å……å¸¸ç”¨çš„æ–¹å¼(<a href="http://www.di-mgt.com.au/cryptopad.html#PKCS5" target="_blank" rel="noopener">PKCS#5</a>)</p>
<p>è¿™ç§æ–¹å¼å…¶å®å°±æ˜¯ç¼ºå°‘å¤šå°‘å­—èŠ‚å°±è¡¥å……å¤šå°‘å­—èŠ‚ï¼Œå…¶è¡¥å……çš„æ•°å€¼å°±æ˜¯å¡«å……çš„å­—èŠ‚çš„æ•°é‡æ¯”å¦‚æ•°æ®å·®2å­—èŠ‚ï¼Œæˆ‘ä»¬å°±è¡¥å……ä¸¤ä¸ª0x02å³å¯ï¼Œå°±æ˜¯å·®å‡ ä¸ªè¡¥å‡ ä¸ªå‡ ï¼Œå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1ly1ffkan9bhisj20oi08kab5.jpg" alt="">  </p>
<p>ä¸‹é¢æˆ‘ä»¬å›é¡¾ä¸€ä¸‹å…³äºcbcæ¨¡å¼çš„è§£å¯†æ–¹å¼</p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkb8les6tj20f206mgm2.jpg" alt="">   </p>
<p>è¿™é‡Œå¯¹æ¯ä¸€åˆ†ç»„è¿›è¡Œä¸€ä¸‹ç»†åˆ†ï¼Œ</p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkbgq2ag6j20f1076wf8.jpg" alt="">  </p>
<p>å¯ä»¥çœ‹å‡ºæœ«å°¾çš„æ•°å€¼ä¸ºå››ä¸ª0Ã—04ï¼Œå³ä¸ºå¡«å……ï¼Œè¿™é‡Œå¦‚æœå¡«å……çš„æ•°å€¼ä¸å¯¹æˆ–è€…æ²¡æœ‰è¿›è¡Œå¡«å……ï¼Œ<strong>è§£å¯†è¿‡ç¨‹å¾€å¾€ä¸ä¼šè¿›è¡Œï¼ŒåŒæ—¶ç¨‹åºä¼šæŠ¥å¼‚å¸¸ã€‚</strong></p>
<p>æœ‰äº†è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å°±æœ‰äº†åˆ©ç”¨ç‚¹ï¼Œåœ¨è¿™ä¸€ç‚¹æœ‰äº›ç±»ä¼¼äºåœ¨SQLæ³¨å…¥ä¸­çš„ç›²æ³¨çš„æ€æƒ³ã€‚</p>
<p>ä¸‹é¢å…·ä½“åˆ†æä¸€ä¸‹ï¼š</p>
<p>åœ¨sqlæ³¨å…¥ä¸­ï¼Œç›²æ³¨æˆ‘ä»¬é€šå¸¸æ˜¯åªæœ‰ä¸¤ç§çŠ¶æ€ï¼Œ<code>true</code>å’Œ<code>false</code></p>
<p>è¿™é‡Œåˆæ˜¯å¦‚ä½•åŒºåˆ†çš„å‘¢ï¼Ÿè¿™é‡Œå…ˆå…·ä½“çœ‹çœ‹å…·ä½“åŸç†åˆ†æ</p>
<p>ä¹‹å‰è¯´åˆ°çš„ä½¿ç”¨æ¡ä»¶æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ivã€çŸ¥é“å¯†æ–‡åŒæ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æœåŠ¡ç«¯è¿›è¡Œè§£å¯†</p>
<p>è¿™é‡Œæ„é€ ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæœåŠ¡ç«¯å¦‚æœç»™ç”¨æˆ·è®¾ç½®äº†è¿™æ ·çš„cookieï¼škey=6d367076036e2239|f851d6cc68fc9537</p>
<p>æˆ‘ä»¬æ¨æµ‹å‡ºâ€˜|â€™ä¹‹å‰çš„æ˜¯ivï¼Œå…¶åé¢çš„æ˜¯åŠ å¯†ç»“æœï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœè¿™é‡Œæˆ‘å°†ivè®¾ç½®ä¸º0000000000000000</p>
<p>å³ä¸ºkey=0000000000000000|f851d6cc68fc9537ï¼Œå‘ç°è¿™ä¸ªæ—¶å€™é¡µé¢å‡ºé”™äº†</p>
<p>çœ‹ä¸€ä¸‹è¿™æ ·å­çš„è§£å¯†è¿‡ç¨‹</p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkc7h3gafj20dp0773z8.jpg" alt="">  </p>
<p>è¿™é‡Œä¹‹å‰æåˆ°çš„æœ‰å…³å¡«å……ï¼Œå¯ä»¥çŸ¥é“ä¸ç®¡æ¶ˆæ¯å¤šé•¿ï¼Œæœ€åè‚¯å®šæ˜¯æœ‰å¡«å……çš„ï¼Œå…¶ä¸­å¡«å……æ•°å€¼èŒƒå›´å’Œåˆ†ç»„çš„å¤§å°æœ‰å…³ï¼Œè¿™é‡Œå¦‚æœæ˜¯DESç®—æ³•8å­—èŠ‚ä¸€ç»„çš„è¯é‚£ä¹ˆæœ€åä¸€ä½çš„èŒƒå›´ä¸€å®šæ˜¯åœ¨0x01~0x08ä¹‹é—´çš„ï¼Œè¿™é‡Œ0x3Dä¸æ˜¯è¿™ä¸ªèŒƒå›´æ•…å‡ºé”™ã€‚</p>
<p>è¿™æ—¶å€™ä½¿ç¨‹åºä¸å‡ºé”™åªæœ‰æœ€åä¸€ä½æ˜¯0x01æ‰å¯ä»¥</p>
<p>æˆ‘ä»¬å¼€å§‹ä¿®æ­£ivï¼Œå‘ç°å½“ivä¸º000000000000003Cçš„æ—¶å€™ç¨‹åºæ²¡æœ‰æŠ¥é”™äº†ï¼Œè¿™ä¸ªæ—¶å€™åˆ†æä¸€ä¸‹è§£å¯†è¿‡ç¨‹</p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkck29su9j20dp07cmxw.jpg" alt="">  </p>
<p>è¿™ä¸ªè¿™ä¸ªæ—¶å€™0x3Då¼‚æˆ–0x3Cä¸º0x01ï¼Œç¨‹åºä»¥ä¸ºè¿™é‡Œçš„å¡«å……ä½ä¸ºä¸€ä½ï¼Œä¹‹å‰çš„å…¨æ˜¯æ•°æ®ï¼Œæ²¡æ¯›ç—…ï¼Œå¼€å§‹è§£å¯†</p>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œ0x3cå¯ä»¥ç©·ä¸¾å¾—å‡ºï¼Œä¸­é—´å€¼0x3då¯ä»¥åˆ©ç”¨0x01å¼‚æˆ–0x3cè®¡ç®—å‡ºï¼ŒåŒæ—¶æˆ‘ä»¬è¿˜çŸ¥é“ä¸€ä¸ªåŸå§‹çš„iv=6d367076036e2239ã€‚</p>
<p>ç”±äº<code>æ˜æ–‡ = ä¸­é—´å€¼ xor IV</code>ï¼Œæˆ‘ä»¬åˆ—ä¸¤ä¸ªå¼å­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x01 = ä¸­é—´å€¼ xor 0x3c</span><br><span class="line"></span><br><span class="line">å¾…æ±‚æ˜æ–‡ = ä¸­é—´å€¼ xor 0x39</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä¸€ä¸ªäºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ï¼Œä¸éš¾è§£å‡ºå¾…æ±‚æ˜æ–‡ã€‚</p>
<p>è¿™æ—¶å€™ç»§ç»­å‘å‰ä¸€ä½è¿›è¡Œæ”»å‡»ï¼Œè¿™æ—¶å€™éœ€è¦åä¸¤ä½ä¸º0x02</p>
<p><img src="http://ww1.sinaimg.cn/large/7e2785d1gy1ffkd1mg5ssj20e207jaat.jpg" alt="">  </p>
<p>ç¬¬å…«ä½å·²ç»è®¡ç®—å‡ºï¼Œè¿™é‡Œåªéœ€è¦é‡å¤ä¹‹å‰çš„æ–¹æ³•è®¡ç®—ç¬¬ä¸ƒä½å³å¯</p>
<p>æœ€å¼€å§‹çœ‹åˆ°è¿™é‡Œä¼šè§‰å¾—æœ‰äº›ç–‘é—®ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ç›´æ¥å¤šä½ä¸€èµ·è®¡ç®—ï¼Œè¿™é‡Œå¯èƒ½ä¼šå‡ºç°è¿™ä¹ˆä¸€ä¸ªæƒ…å†µï¼Œå‡è®¾æœ€åä¸€ä½æ˜¯ä¸€ä¸ªåˆç†çš„å¡«å……ï¼ˆå‡è®¾å…«å­—èŠ‚åˆ†ç»„0x01~0x08ï¼‰ç¬¬ä¸ƒä½æ˜¯ä¸ªé”™è¯¯çš„å€¼æ—¶å€™ï¼Œå°±ä¼šå‡ºç°éé¢„æœŸçš„é”™è¯¯ï¼Œæ¯”å¦‚ä¸­é—´å€¼çš„åä¸¤ä½ä¸º0x00å’Œ0x02ï¼Œæˆ‘ä»¬æ„é€ çš„åˆå§‹å‘é‡çš„åä¸¤ä½ä¸º0x02å’Œ0x00ï¼Œè¿™æ—¶å€™ç¨‹åºå¹¶ä¸ä¼šæŠ¥é”™ã€‚</p>
<p> ä»¥æ­¤ç±»æ¨æˆ‘ä»¬ä¾¿å¯ä»¥è·å–åˆ°æ˜æ–‡ã€‚</p>
<p>å¦‚æœè¿™é‡Œæˆ‘ä»¬å¹¶<strong>ä¸çŸ¥é“åˆå§‹iv</strong>ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥è¿›è¡Œæ”»å‡»ï¼Œåªä¸è¿‡ç¬¬ä¸€ç»„çš„æ•°æ®æ— æ³•è·å–åˆ°</p>
<p>ä»”ç»†å›é¡¾ä¸€ä¸‹ä¸Šè¿°çš„åŠ å¯†æ–¹å¼ï¼Œæˆ‘ä»¬çš„åˆå§‹ivåªæ˜¯åŠ å¯†ç¬¬ä¸€ç»„æ•°æ®ä¸­ç”¨å¾—åˆ°ï¼ŒåŠ å¯†ç¬¬äºŒç»„æ•°æ®çš„æ—¶å€™å…¶å®å°±æ˜¯ç”¨çš„ç¬¬ä¸€ç»„çš„å¯†æ–‡å……å½“ivçš„è§’è‰²ç»§ç»­åŠ å¯†ï¼Œæˆ‘ä»¬è¿™é‡Œåªéœ€è¦ä¸æ–­ä¿®æ”¹åˆ†ç»„ä¸Šä¸€åˆ†ç»„çš„å¯†æ–‡å³å¯å¾—åˆ°ä¸‹ä¸€ç»„çš„æ˜æ–‡ã€‚</p>
<h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>æœ‰å…³çš„ä¾‹å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$type = <span class="string">"aes-128-cbc"</span>;	<span class="comment">//åŠ å¯†ç±»å‹ï¼Œå³åˆ†ç»„å¤§å°ä¸º16</span></span><br><span class="line">$P = <span class="string">"aaaaaaa"</span>;	<span class="comment">//æ˜æ–‡</span></span><br><span class="line">$Key = <span class="string">"aAbBcCdDeE"</span>;	<span class="comment">//åŠ å¯†è¦ç”¨åˆ°çš„Key</span></span><br><span class="line">$IV = <span class="string">"thisivthisivthis"</span>;	<span class="comment">//åˆå§‹åŒ–å‘é‡ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªå¼‚æˆ–çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å®ƒçš„å¤§å°å’Œåˆ†ç»„å¤§å°è¦ä¸€æ ·</span></span><br><span class="line">$C = openssl_encrypt($P, $type, $Key, OPENSSL_RAW_DATA, $IV);</span><br><span class="line"><span class="comment">//æ»¡è¶³padding oracle attackå‰ææ¡ä»¶1</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"iv: "</span>.bin2hex($IV).<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"c: "</span>.bin2hex($C).<span class="string">"&lt;br&gt;"</span>;	<span class="comment">//å¯èƒ½å­˜åœ¨ä¸å¯æ˜¾ç¤ºçš„å­—ç¬¦ï¼ŒåŠ ä¸ªbase64çš„ç¼–ç </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'s'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'iv'</span>]))&#123;</span><br><span class="line">	$s = hex2bin($_GET[<span class="string">'s'</span>]);</span><br><span class="line">	$iv = hex2bin($_GET[<span class="string">'iv'</span>]);</span><br><span class="line">	<span class="keyword">if</span>(($n = openssl_decrypt($s, $type, $Key, OPENSSL_RAW_DATA, $iv)) !== <span class="keyword">false</span>)&#123;		<span class="comment">//è§£å¯†å¤±è´¥ä¼šè¿”å›false</span></span><br><span class="line">		<span class="comment">//bit flipping attack</span></span><br><span class="line">		<span class="keyword">echo</span> $n;</span><br><span class="line">		<span class="keyword">if</span>($n === <span class="string">"admin"</span>)&#123;</span><br><span class="line">			<span class="keyword">print</span> <span class="string">"well done!"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="comment">//æ»¡è¶³padding oracle attackå‰ææ¡ä»¶2</span></span><br><span class="line">		<span class="keyword">die</span>(<span class="string">"Fail!"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url = <span class="string">'http://192.168.248.1/test/demo.php'</span></span><br><span class="line">N = <span class="number">16</span></span><br><span class="line">l = [<span class="number">0</span>] * N</span><br><span class="line">iv = <span class="string">'74686973697674686973697674686973'</span>.decode(<span class="string">'hex'</span>)</span><br><span class="line">tmp_iv = <span class="string">''</span></span><br><span class="line">out = [<span class="number">0</span>] * N</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, N+<span class="number">1</span>):</span><br><span class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">		l[N-i] = c</span><br><span class="line">		tmp_iv = <span class="string">''</span></span><br><span class="line">		<span class="keyword">for</span> m <span class="keyword">in</span> l:</span><br><span class="line">			tmp_iv += chr(m)</span><br><span class="line">		<span class="keyword">print</span> tmp_iv.encode(<span class="string">'hex'</span>)</span><br><span class="line">		payload = <span class="string">"?s=e211ffa0baa91627a5827f3867a0cff1&amp;iv="</span> + tmp_iv.encode(<span class="string">'hex'</span>)</span><br><span class="line">		<span class="comment">#print payload</span></span><br><span class="line">		data = requests.get(url+payload).content</span><br><span class="line">		<span class="keyword">if</span> <span class="string">'Fail!'</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">			out[N-i] = c ^ i</span><br><span class="line">			<span class="keyword">for</span> y <span class="keyword">in</span> range(i):</span><br><span class="line">				l[N-y<span class="number">-1</span>] = out[N-y<span class="number">-1</span>] ^ (i+<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">	out[i] = out[i] ^ ord(iv[i])</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> out:</span><br><span class="line">	s += chr(c)</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure>
<p>pythonæœ‰ä¸€ä¸ªå…³äºæ­¤æ–¹å¼åˆ©ç”¨çš„åº“ï¼Œ<a href="https://github.com/mwielgoszewski/python-paddingoracle" target="_blank" rel="noopener">é¡¹ç›®åœ°å€</a></p>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="http://k1n9.me/2017/03/16/attack-in-cbc/" target="_blank" rel="noopener">http://k1n9.me/2017/03/16/attack-in-cbc/</a></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/leejgod">Projects</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CBCåŠ å¯†æ¨¡å¼"><span class="toc-number">1.</span> <span class="toc-text">CBCåŠ å¯†æ¨¡å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#å­—èŠ‚ç¿»è½¬æ”»å‡»"><span class="toc-number">1.1.</span> <span class="toc-text">å­—èŠ‚ç¿»è½¬æ”»å‡»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°"><span class="toc-number">1.1.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è¯¦è§£"><span class="toc-number">1.1.2.</span> <span class="toc-text">è¯¦è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CTFå®ä¾‹"><span class="toc-number">1.1.3.</span> <span class="toc-text">CTFå®ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Padding-Oracle-Attack"><span class="toc-number">1.2.</span> <span class="toc-text">Padding Oracle Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è¯¦è§£-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">è¯¦è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å®ä¾‹"><span class="toc-number">1.2.3.</span> <span class="toc-text">å®ä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å‚è€ƒ"><span class="toc-number">1.2.4.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&text=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&is_video=false&description=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·&body=Check out this article: http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&title=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://blog.leej.me/2017/05/15/åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·/&name=åˆ†ç»„å¯†ç CBCåŠ å¯†ç¼ºé™·&description=&lt;p&gt;å…³äºå¯†ç å­¦çš„ç§ç§æ¼æ´ä»¥åŠåˆ©ç”¨ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘ï¼Œä½†æ˜¯æ¯”è¾ƒé›¶æ•£ï¼Œæœ‰å…³ä»‹ç»æ¯”è¾ƒå±€é™ï¼Œå¯¼è‡´ä¸€äº›ä¸œè¥¿æ™¦æ¶©éš¾æ‡‚ä¸æ˜“ç†è§£ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªæœ‰å…³äºCBCåˆ†ç»„åŠ å¯†çš„ä¸€ä¸ªè®²è§£&lt;/p&gt;"><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Leej
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/leejgod">Projects</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


